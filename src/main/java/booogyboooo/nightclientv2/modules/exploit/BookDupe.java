package booogyboooo.nightclientv2.modules.exploit;

import java.util.List;
import java.util.Optional;

import booogyboooo.nightclientv2.event.module.ModuleEvents;
import booogyboooo.nightclientv2.module.Module;
import booogyboooo.nightclientv2.module.ModuleType.Type;
import booogyboooo.nightclientv2.util.Key;
import it.unimi.dsi.fastutil.ints.Int2ObjectMaps;
import net.minecraft.item.ItemStack;
import net.minecraft.item.Items;
import net.minecraft.screen.slot.SlotActionType;
import net.minecraft.text.Text;
import net.minecraft.network.packet.c2s.play.BookUpdateC2SPacket;
import net.minecraft.network.packet.c2s.play.ClickSlotC2SPacket;

public class BookDupe extends Module implements ModuleEvents {
	
	public BookDupe() {
		super(Type.Exploits, "BookDupe", "Default", Key.NONE.key());
		this.addMode("Default");
	}
	
	@Override
	public void onEnable() {
		if (mc.player == null) {
			return;
		}
		if (!(mc.player.getInventory().getMainHandStack().getItem() == Items.WRITABLE_BOOK)) {
			mc.player.sendMessage(Text.of("BookDupe: You need to hold a book and quill"));
		}
		
        for (int i = 9; i < 44; i++) {
            if (36 + mc.player.getInventory().selectedSlot == i) {
            	continue;
            }
            mc.player.networkHandler.sendPacket(new ClickSlotC2SPacket(mc.player.currentScreenHandler.syncId, mc.player.currentScreenHandler.getRevision(), i, 1, SlotActionType.THROW, ItemStack.EMPTY, Int2ObjectMaps.emptyMap()));
        }
        
        mc.player.networkHandler.sendPacket(new BookUpdateC2SPacket(mc.player.getInventory().selectedSlot, List.of("BookDupe: Failed to dupe. Is it patched?"), Optional.of("BookDupe: Failed to dupe. Is it patched?")));
        this.toggle(false);
	}
	
}